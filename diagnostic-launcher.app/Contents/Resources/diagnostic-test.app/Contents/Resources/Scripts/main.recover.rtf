{\rtf1\ansi\ansicpg1252\cocoartf1671\cocoasubrtf100
{\fonttbl\f0\fnil\fcharset0 Verdana-Italic;\f1\fnil\fcharset0 Verdana;\f2\fnil\fcharset0 Verdana-Bold;
}
{\colortbl;\red255\green255\blue255;\red74\green80\blue93;\red85\green83\blue115;\red159\green77\blue161;
\red214\green85\blue98;\red146\green155\blue173;\red222\green180\blue104;\red66\green146\blue158;\red41\green98\blue158;
\red118\green171\blue94;\red157\green109\blue69;\red41\green98\blue158;\red66\green146\blue158;\red157\green109\blue69;
}
{\*\expandedcolortbl;;\cssrgb\c35993\c38693\c44141;\cssrgb\c40710\c40651\c52602;\cssrgb\c68994\c39776\c69258;
\cssrgb\c87705\c42493\c46033;\cssrgb\c63922\c67261\c73310;\cssrgb\c89880\c75331\c48022;\cssrgb\c31682\c63512\c68076;\cssrgb\c20281\c46615\c68276;
\cssrgb\c52915\c71699\c44414;\cssrgb\c68152\c50282\c33994;\cssrgb\c20444\c46462\c68262;\cssrgb\c31457\c63567\c68235;\cssrgb\c68060\c50379\c34089;
}
\deftab480
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i\fs24 \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 ---------- GLOBAL VARIABLES AND PROPERTIES
\f1\i0 \cf3 \
\

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\
\
\
\

\f0\i \cf2 -- set from setGlobals()
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 oldDelims\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 tmpFiles\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 currentVersion\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 mainAppName\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 mainAppNameLong\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 userHomeFolder\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 configFolder\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 myPath\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 myPathPOSIX\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 myFolderPath\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 myFolderPathPOSIX\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 resourcesFolder\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 alphabetList\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 -- set from getSpecs()
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 deviceGPUList\cf3 , \cf5 deviceScreenResolution\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 deviceModelName\cf3 , \cf5 deviceModelIdentifier\cf3 , \cf5 deviceProcessorName\cf3 , \cf5 deviceProcessorSpeed\cf3 , \cf5 deviceProcessorCores\cf3 , \cf5 deviceRAM\cf3 , \cf5 deviceSerialNumber\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 deviceRAMSizeList\cf3 , \cf5 deviceRAMSpeedList\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 driveListInfo\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 configCode\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 deviceProductClass\cf3 , \cf5 deviceYear\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 -- set from checkForUpdates()
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 gitRemote\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 gitBranch\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 plistAddress\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 newestVersion\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 -- set from diagnostic()
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 checkVST\cf3 \

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 osVersion\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 -- set from MAIN SCRIPT
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 mainAppList\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 -- for progress bar
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 global
\f1\b0 \cf3  \cf5 x\cf3 \
\
\
\
\
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 ---------- HANDLES
\f1\i0 \cf3 \
\

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\
\
\
\
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 setGlobalsMissing\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \{\cf5 oldDelims\cf3 , \cf5 tmpFiles\cf3 , \cf5 currentVersion\cf3 , \cf5 mainAppName\cf3 , \cf5 mainAppNameLong\cf3 , \cf5 userHomeFolder\cf3 , \cf5 configFolder\cf3 , \cf5 myPath\cf3 , \cf5 myPathPOSIX\cf3 , \cf5 myFolderPath\cf3 , \cf5 myFolderPathPOSIX\cf3 , \cf5 resourcesFolder\cf3 , \cf5 alphabetList\cf3 , \cf5 deviceGPUList\cf3 , \cf5 deviceScreenResolution\cf3 , \cf5 deviceModelName\cf3 , \cf5 deviceModelIdentifier\cf3 , \cf5 deviceProcessorName\cf3 , \cf5 deviceProcessorSpeed\cf3 , \cf5 deviceProcessorCores\cf3 , \cf5 deviceRAM\cf3 , \cf5 deviceSerialNumber\cf3 , \cf5 deviceRAMSizeList\cf3 , \cf5 deviceRAMSpeedList\cf3 , \cf5 driveListInfo\cf3 , \cf5 configCode\cf3 , \cf5 deviceProductClass\cf3 , \cf5 deviceYear\cf3 , \cf5 gitRemote\cf3 , \cf5 gitBranch\cf3 , \cf5 plistAddress\cf3 , \cf5 newestVersion\cf3 , \cf5 checkVST\cf3 , \cf5 osVersion\cf3 , \cf5 mainAppList\cf3 , \cf5 x\cf3 \} 
\f2\b \cf4 to
\f1\b0 \cf3  \{
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 , 
\f0\i \cf7 missing value
\f1\i0 \cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 setGlobalsMissing\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 mainAppError\cf3 (\cf5 errorNumber\cf3 , \cf5 errorDescription\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf10 "Error: "\cf3  & \cf5 errorNumber\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  & \cf10 " encountered an error and needs to close."\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Details:"\cf3  & \cf11 return\cf3  & \cf5 errorDescription\cf3  \cf12 with title\cf3  \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  \cf12 buttons\cf3  \{\cf10 "Quit"\cf3 \} \cf12 default button\cf3  \cf7 1\cf3  \cf12 giving up after\cf3  \cf7 259200\cf3 )\
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 gave up\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf5 e\cf3  \cf12 with title\cf3  \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  \cf12 buttons\cf3  \{\cf10 "Quit"\cf3 \} \cf12 default button\cf3  \cf7 1\cf3  \cf12 giving up after\cf3  \cf7 259200\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 gave up\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 mainAppError\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 appError\cf3 (\cf5 appName\cf3 , \cf5 errorNumber\cf3 , \cf5 errorDescription\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf10 "Error: "\cf3  & \cf5 errorNumber\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf5 appName\cf3  & \cf10 " encountered an error."\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Details:"\cf3  & \cf11 return\cf3  & \cf5 errorDescription\cf3  \cf12 with title\cf3  \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  \cf12 buttons\cf3  \{\cf10 "Quit"\cf3 , \cf10 "Continue"\cf3 \} \cf12 default button\cf3  \cf7 2\cf3  \cf12 giving up after\cf3  \cf7 259200\cf3 )\
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 gave up\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 mainAppError\cf3 (\cf10 "Main_App:001"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 button returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Quit"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 appError\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 openApp\cf3 (\cf5 appName\cf3 , \cf5 errorNumber\cf3 , \cf5 progressBarTest\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 progressBarTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
		\cf6 progressBar\cf3 (\cf7 30\cf3 , \cf5 x\cf3 , \cf10 "Opening Applications"\cf3 , \cf10 "Opening "\cf3  & \cf5 appName\cf3  & \cf10 "..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 progressBarTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 progressBarMultiplier\cf3 (\cf7 15\cf3 , \cf14 true\cf3 )\
		
\f2\b \cf8 activate
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf5 appName\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
		
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 15\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.3\cf3 \
					
\f2\b \cf4 if
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf5 appName\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf11 running\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 appName\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Terminal"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Terminal"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf8 close
\f1\b0 \cf3  
\f0\i \cf7 windows
\f1\i0 \cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 progressBarTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 progressBarMultiplier\cf3 (\cf7 15\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 appError\cf3 (\cf5 appName\cf3 , \cf5 errorNumber\cf3 , \cf10 "Error opening app - "\cf3  & \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 openApp\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 quitApp\cf3 (\cf5 appName\cf3 , \cf5 errorNumber\cf3 , \cf5 progressBarTest\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 progressBarTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
		\cf6 progressBar\cf3 (\cf7 30\cf3 , \cf5 x\cf3 , \cf10 "Quitting Applications"\cf3 , \cf10 "Checking for "\cf3  & \cf5 appName\cf3  & \cf10 "..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 appName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Finder"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 progressBarTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Checking for Finder windows..."\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 finderWindowList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 the
\f1\b0 \cf3  \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 every
\f1\b0 \cf3  
\f0\i \cf7 window
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Finder"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf11 length\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 finderWindowList\cf3  > \cf7 0\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 progressBarTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Closing Finder windows..."\cf3 )\
				\cf6 progressBarMultiplier\cf3 (\cf7 15\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Finder"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf8 close
\f1\b0 \cf3  
\f0\i \cf7 windows
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf7 30\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 )\
			
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.005\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf5 appName\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf11 running\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 progressBarTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Quitting "\cf3  & \cf5 appName\cf3  & \cf10 "..."\cf3 )\
				\cf6 progressBarMultiplier\cf3 (\cf7 15\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
				
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "killall "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 appName\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 progressBarTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				\cf6 progressBarMultiplier\cf3 (\cf7 15\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 appError\cf3 (\cf5 appName\cf3 , \cf5 errorNumber\cf3 , \cf10 "Error closing app - "\cf3  & \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
			
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf10 "tried to quit with command:"\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "killall "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 appName\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 progressBarTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf7 30\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 )\
			
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.005\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 quitApp\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf7 30\cf3 , \cf5 x\cf3 , \cf10 "Quitting"\cf3 , \cf10 ""\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 40\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 setGlobalsMissing\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 quit
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 quitMainApp\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 progressBar\cf3 (\cf5 pTotalSteps\cf3 , \cf5 pCompletedSteps\cf3 , \cf5 pDescription\cf3 , \cf5 pAddDescription\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 pTotalSteps\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 "***"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 progress total steps\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 pTotalSteps\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 pCompletedSteps\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 "***"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 progress completed steps\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 pCompletedSteps\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 pDescription\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 "***"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 progress description\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 pDescription\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 pAddDescription\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 "***"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 progress additional description\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 pAddDescription\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 progressBar\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 runScript\cf3 (\cf5 scriptName\cf3 , \cf5 outputFile\cf3 )\
	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "osascript "\cf3  & \cf5 resourcesFolder\cf3  & \cf10 "Scripts/"\cf3  & \cf5 scriptName\cf3  & \cf10 " > "\cf3  & \cf5 outputFile\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 runScript\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 progressBarMultiplier\cf3 (\cf5 amountToRepeat\cf3 , \cf5 quitTest\cf3 )\
	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3  \cf5 amountToRepeat\cf3  
\f2\b \cf4 times
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 x\cf3  + \cf7 1\cf3 \
			
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.01\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 progress completed steps\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 x\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 quitTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 progressBarMultiplier\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 loadingProgressBar\cf3 (\cf5 processName\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf7 30\cf3 , \cf5 x\cf3 , \cf5 processName\cf3 , \cf10 "Loading\'85"\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 40\cf3 , \cf14 true\cf3 )\
	\cf6 progressBar\cf3 (\cf7 1\cf3 , \cf7 0\cf3 , \cf5 processName\cf3 , \cf10 "Waiting for User input\'85"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 loadingProgressBar\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 unmountDisks\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 diskList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 paragraphs
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "ls /Volumes"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentDisk\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 diskList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f0\i \cf2 --display dialog currentDisk
\f1\i0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 unmountDisks\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 setGlobals\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 loadingProgressBar\cf3 (\cf10 "Hardware Scan"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 process
\f1\i0 \cf3  \cf10 "NotificationCenter"\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 numwins\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf8 count
\f1\b0 \cf3  
\f0\i \cf7 windows
\f1\i0 \cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 i\cf3  
\f2\b \cf4 from
\f1\b0 \cf3  \cf5 numwins\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 1\cf3  
\f2\b \cf4 by
\f1\b0 \cf3  \cf7 -1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf8 click
\f1\b0 \cf3  
\f0\i \cf7 button
\f1\i0 \cf3  \cf10 "Close"\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 window
\f1\i0 \cf3  \cf5 i\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf7 65\cf3 , \cf5 x\cf3 , \cf10 "Hardware Scan"\cf3 , \cf10 "Getting "\cf3  & \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  & \cf10 " information..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 oldDelims\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 tmpFiles\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 POSIX path\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  ((
\f2\b \cf9 path to
\f1\b0 \cf3  \cf13 temporary items\cf3 ) 
\f2\b \cf4 as
\f1\b0 \cf3  
\f0\i \cf7 text
\f1\i0 \cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentVersion\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 version
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 mainAppName\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  & \cf10 " Version "\cf3  & \cf5 currentVersion\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 userHomeFolder\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 POSIX path\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 path to
\f1\b0 \cf3  \cf13 home folder\cf3  \cf12 as\cf3  
\f0\i \cf7 text
\f1\i0 \cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configFolder\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 userHomeFolder\cf3  & \cf10 "Documents/configFiles/"\cf3 \
		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  (
\f2\b \cf8 exists
\f1\b0 \cf3  
\f0\i \cf7 folder
\f1\i0 \cf3  \cf5 configFolder\cf3 ) 
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "mkdir "\cf3  & \cf5 configFolder\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 myPath\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 path to
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 myPathPOSIX\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 POSIX path\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 myPath\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 resourcesFolder\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 myPathPOSIX\cf3  & \cf10 "Contents/Resources/"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Finder"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 myFolderPath\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 container
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 myPath\cf3  
\f2\b \cf4 as
\f1\b0 \cf3  
\f0\i \cf7 alias
\f1\i0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 myFolderPathPOSIX\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 POSIX path\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 myFolderPath\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ":"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 mainAppNameLong\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 -2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (\cf5 myPath\cf3  
\f2\b \cf4 as
\f1\b0 \cf3  
\f0\i \cf7 string
\f1\i0 \cf3 )\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 myFolderName\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 -2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (\cf5 myFolderPath\cf3  
\f2\b \cf4 as
\f1\b0 \cf3  
\f0\i \cf7 string
\f1\i0 \cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 oldDelims\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 alphabetList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\}\
		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 tmpNumber\cf3  
\f2\b \cf4 from
\f1\b0 \cf3  \cf7 0\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 25\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 tmpChar\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 character
\f1\i0 \cf3  \cf14 id\cf3  (\cf5 tmpNumber\cf3  + \cf7 97\cf3 )\
			
\f2\b \cf4 copy
\f1\b0 \cf3  \cf5 tmpChar\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 alphabetList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 getSpecs\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 mainAppError\cf3 (\cf10 "Main_App:002"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 setGlobals\cf3 \
\
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 getSpecs\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \{\cf5 SPDisplaysDataType\cf3 , \cf5 SPHardwareDataType\cf3 , \cf5 SPHardwareRAIDDataType\cf3 , \cf5 SPMemoryDataType\cf3 \} 
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "SPDisplaysDataType"\cf3 , \cf10 "SPHardwareDataType"\cf3 , \cf10 "SPHardwareRAIDDataType"\cf3 , \cf10 "SPMemoryDataType"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 systemProfilerList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf5 SPDisplaysDataType\cf3 , \cf5 SPHardwareDataType\cf3 , \cf5 SPHardwareRAIDDataType\cf3 , \cf5 SPMemoryDataType\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ": "\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 systemProfilerList\cf3 \
		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Running "\cf3  & \cf5 currentSystemProfiler\cf3  & \cf10 " system_profiler..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentSystemProfilerName\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "system_profiler "\cf3  & \cf5 currentSystemProfiler\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSystemProfilerName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "SPDisplaysDataType"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 SPDisplaysDataType\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theDelimiterList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\}\
			
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 tmpChar\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 alphabetList\cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 tmpItem\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "    "\cf3  & \cf5 tmpChar\cf3 \
				
\f2\b \cf4 copy
\f1\b0 \cf3  \cf5 tmpItem\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 theDelimiterList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 theDelimiterList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theGPUDataList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\}\
			
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentItem\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  (
\f2\b \cf4 every
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3 )\
				
\f2\b \cf4 copy
\f1\b0 \cf3  \cf5 currentItem\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 theGPUDataList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceGPUList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\}\
			
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentGPU\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 theGPUDataList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentGPU\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 currentGPU\cf3  
\f2\b \cf4 as
\f1\b0 \cf3  
\f0\i \cf7 text
\f1\i0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentGPUParagraphs\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 paragraphs
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentGPU\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentGPU\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 " Displays"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Displays:"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceDisplays\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 -1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentGPU\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ":"\cf3  & \cf11 return\cf3  & \cf10 "          "\cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceDisplaysItems\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text items
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 deviceDisplays\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentDisplay\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 deviceDisplaysItems\cf3 \
						
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentDisplay\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Built-In: Yes"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentDisplayParagraphs\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 paragraphs
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentDisplay\cf3 \
							
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 currentDisplayParagraphs\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 								\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 								
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Resolution"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 									\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 									
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenResolution\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 word
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentSpec\cf3  & \cf11 space\cf3  & 
\f0\i \cf7 word
\f1\i0 \cf3  \cf7 4\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentSpec\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 									\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 									
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 theDelimiterList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 									\
								
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
								\
							
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
							\
						
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 tmpGPUData\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ""\cf3 \
				
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 currentGPUParagraphs\cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ": "\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Chipset Model"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
						
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 tmpGPUData\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 tmpGPUData\cf3  & \cf10 "Model= "\cf3  & 
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentSpec\cf3  & \cf10 ": "\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						\
					
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "VRAM"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 tmpGPUData\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 tmpGPUData\cf3  & \cf10 "VRAM= "\cf3  & 
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentSpec\cf3  & \cf10 ": "\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 theDelimiterList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 tmpGPUData\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 copy
\f1\b0 \cf3  \cf5 tmpGPUData\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 deviceGPUList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSystemProfilerName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "SPHardwareDataType"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 SPHardwareDataType\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theDesiredList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Model Name"\cf3 , \cf10 "Model Identifier"\cf3 , \cf10 "Processor Name"\cf3 , \cf10 "Processor Speed"\cf3 , \cf10 "Total Number of Cores"\cf3 , \cf10 "Memory"\cf3 , \cf10 "Serial Number"\cf3 \}\
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theFinalList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ": "\cf3 \
			
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentDesiredSpec\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 theDesiredList\cf3 \
				
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  (
\f0\i \cf7 paragraphs
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3 )\
					
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf5 currentDesiredSpec\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 copy
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 -1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 theFinalList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \{\cf5 deviceModelName\cf3 , \cf5 deviceModelIdentifier\cf3 , \cf5 deviceProcessorName\cf3 , \cf5 deviceProcessorSpeed\cf3 , \cf5 deviceProcessorCores\cf3 , \cf5 deviceRAM\cf3 , \cf5 deviceSerialNumber\cf3 \} 
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 theFinalList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSystemProfilerName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "SPHardwareRAIDDataType"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 SPHardwareRAIDDataType\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceRAIDStatus\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceRAIDStatus\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSystemProfilerName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "SPMemoryDataType"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 SPMemoryDataType\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "        "\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceRAMSizeList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\}\
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceRAMSpeedList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\}\
			
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentItem\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  (
\f2\b \cf4 every
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentSystemProfiler\cf3 )\
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentItemParagraphs\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 paragraphs
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentItem\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentItem\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Upgradeable Memory"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 currentItemParagraphs\cf3 \
						
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Upgradeable Memory"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Yes"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
								
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceUpgradeableRAM\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 								\
							
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "No"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 								
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceUpgradeableRAM\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 								\
							
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 								
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceUpgradeableRAM\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "UNKNOWN"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 								\
							
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
							\
						
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentItem\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Size: "\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ": "\cf3 \
					
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 currentItemParagraphs\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Size"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
							
\f2\b \cf4 copy
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 -1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 deviceRAMSizeList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							\
						
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Speed"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							
\f2\b \cf4 copy
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 -1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentSpec\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 deviceRAMSpeedList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							\
						
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "        "\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Gathering diskutil information..."\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 driveListData\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "diskutil list"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "/dev/"\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 driveListDataItems\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text items
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 driveListData\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 oldDelims\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 driveList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\}\
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentDrive\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 driveListDataItems\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 " "\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentDriveNumber\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentDrive\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentDriveNumber\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Disk"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Gathering diskutil information for "\cf3  & \cf5 currentDriveNumber\cf3  & \cf10 "..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3  / (\cf11 length\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 driveListDataItems\cf3 ), \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentDrive\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "internal"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 copy
\f1\b0 \cf3  \cf5 currentDriveNumber\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 driveList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Gathering smartctl information..."\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 smartctlVersion\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "ls /usr/local/Cellar/smartmontools/"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 smartctlVersion\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ""\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 smartctlParagraphs\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 length\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 paragraphs
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 smartctlVersion\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 smartctlParagraphs\cf3  > \cf7 1\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 smartCommandPath\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ""\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "smartctl seems to have more than one version installed. Remove all but one version."\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 smartctlParagraphs\cf3  = \cf7 0\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 smartCommandPath\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ""\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "smartctl needs to be installed to get storage information."\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 smartctlParagraphs\cf3  = \cf7 1\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 smartCommandPath\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "/usr/local/Cellar/smartmontools/"\cf3  & \cf5 smartctlVersion\cf3  & \cf10 "/bin/smartctl"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 smartCommandPath\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 driveListInfo\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\}\
		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentDrive\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 driveList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Gathering smartctl information for "\cf3  & \cf5 currentDrive\cf3  & \cf10 "..."\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3  / (\cf11 length\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 driveList\cf3 ), \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 infoCommand\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 smartCommandPath\cf3  & \cf10 " -i "\cf3  & \cf5 currentDrive\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 healthCommand\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 smartCommandPath\cf3  & \cf10 " -A "\cf3  & \cf5 currentDrive\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf5 infoCommand\cf3  & \cf10 " | grep 'Model Family:' | awk '\{$1=$2=\\"\\"; print $0\}'"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "**"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Seagate"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Seagate"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Hitachi"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Hitachi"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "HGST"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Hitachi"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Western"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Western Digital"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "WD"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Western Digital"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Samsung"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Samsung"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelFamily\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text
\f1\i0 \cf3  \cf7 3\cf3  
\f2\b \cf4 through
\f1\b0 \cf3  \cf7 -1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 modelFamily\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelNumber\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf5 infoCommand\cf3  & \cf10 " | grep 'Device Model:' | awk '\{$1=$2=\\"\\"; print $0\}'"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 modelNumber\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelNumber\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "**"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 modelNumber\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text
\f1\i0 \cf3  \cf7 3\cf3  
\f2\b \cf4 through
\f1\b0 \cf3  \cf7 -1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 modelNumber\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 capacity\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf5 infoCommand\cf3  & \cf10 " | grep 'User Capacity:' | awk '\{print $5, $6\}'"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 capacity\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 capacity\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "**"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 capacity\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 through
\f1\b0 \cf3  \cf7 -2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 capacity\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 rotationSpeed\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf5 infoCommand\cf3  & \cf10 " | grep 'Rotation Rate:' | awk '\{print $3\}'"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 rotationSpeed\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 rotationSpeed\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "**"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 RSC\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf5 healthCommand\cf3  & \cf10 " | grep '5 Reallocated_Sector_Ct' | awk '\{print $10\}'"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 RSC\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 RSC\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "**"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 RUE\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf5 healthCommand\cf3  & \cf10 " | grep '187 Reported_Uncorrect' | awk '\{print $10\}'"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 RUE\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 RUE\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "**"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 CPS\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf5 healthCommand\cf3  & \cf10 " | grep '197 Current_Pending_Sector' | awk '\{print $10\}'"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 CPS\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 CPS\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "**"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 OUS\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf5 healthCommand\cf3  & \cf10 " | grep '98 Offline_Uncorrectable' | awk '\{print $10\}'"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 OUS\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 OUS\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "**"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 UDMA\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf5 healthCommand\cf3  & \cf10 " | grep '199 UDMA_CRC_Error_Count' | awk '\{print $10\}'"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 UDMA\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 UCE\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "**"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 smartStatus\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "diskutil info "\cf3  & \cf5 currentDrive\cf3  & \cf10 " | grep 'SMART'"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 smartStatus\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Verified"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 smartStatus\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 smartStatus\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 smartStatus\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 RSC\cf3  > \cf7 0\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 driveFailed\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 CPS\cf3  > \cf7 0\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 driveFailed\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 smartStatus\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 driveFailed\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 driveFailed\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 copy
\f1\b0 \cf3  \cf5 currentDrive\cf3  & \cf10 " | Make="\cf3  & \cf5 modelFamily\cf3  & \cf10 " | Model="\cf3  & \cf5 modelNumber\cf3  & \cf10 " | Size="\cf3  & \cf5 capacity\cf3  & \cf10 " | Rotation Speed="\cf3  & \cf5 rotationSpeed\cf3  & \cf10 " | Reallocated Sectors="\cf3  & \cf5 RSC\cf3  & \cf10 " | Reported Uncorrectable="\cf3  & \cf5 RUE\cf3  & \cf10 " | Current Pending="\cf3  & \cf5 CPS\cf3  & \cf10 " | Offline Uncorrectable="\cf3  & \cf5 OUS\cf3  & \cf10 " | UDMA CRC Errors="\cf3  & \cf5 UDMA\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 driveListInfo\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 mainAppError\cf3 (\cf10 "Main_App:003"\cf3 , \cf5 messageText\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "to install smartmontools with homebrew, run the following command in terminal:"\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "brew install smartmontools"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 getSpecs\cf3 \
\
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 getConfigCode\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Downloading Config Code..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 endSerial\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text
\f1\i0 \cf3  \cf7 -4\cf3  
\f2\b \cf4 through
\f1\b0 \cf3  \cf7 -1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 deviceSerialNumber\cf3 \
	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 xmlText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "cd "\cf3  & \cf5 tmpFiles\cf3  & \cf10 ";curl https://support-sp.apple.com/sp/product?cc="\cf3  & \cf5 endSerial\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 xmlText\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "error"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 yes\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 xmlText\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "iPhone"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 yes\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 xmlText\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "iPad"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 yes\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 xmlText\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "iPod"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 yes\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 xmlText\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Watch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 yes\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 no\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 yes\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 endSerial\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text
\f1\i0 \cf3  \cf7 -3\cf3  
\f2\b \cf4 through
\f1\b0 \cf3  \cf7 -1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 deviceSerialNumber\cf3 \
		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 xmlText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "cd "\cf3  & \cf5 tmpFiles\cf3  & \cf10 ";curl https://support-sp.apple.com/sp/product?cc="\cf3  & \cf5 endSerial\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 xmlText\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "error"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Unknown"\cf3 \
		
\f2\b \cf4 return
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "><"\cf3 \}\
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 xmlTextItems\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 every
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 xmlText\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 textItem\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 xmlTextItems\cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 textItem\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "configCode"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "<"\cf3 , \cf10 ">"\cf3 \}\
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 xmlData\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 every
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 textItem\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 ", "\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 xmlData\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Unknown"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 oldDelims\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 serviceAccountPath\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 configFolder\cf3  & \cf10 "gdrive.json"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  (
\f2\b \cf8 exists
\f1\b0 \cf3  
\f0\i \cf7 file
\f1\i0 \cf3  \cf5 serviceAccountPath\cf3 ) 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 getConfigCode\cf3 \
\
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 buildSpecs\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Matching specs..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceModelNumber\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "***"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "iMac"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceProductClass\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Desktop"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Mac Pro"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceProductClass\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Desktop"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "MacBook"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceProductClass\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Laptop"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceProductClass\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "UNKNOWN"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 " "\cf3 , \cf10 "("\cf3 , \cf10 ")"\cf3 , \cf10 ","\cf3 , \cf10 "-"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theNumList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf7 1\cf3 , \cf7 2\cf3 , \cf7 3\cf3 , \cf7 4\cf3 , \cf7 5\cf3 , \cf7 6\cf3 , \cf7 7\cf3 , \cf7 8\cf3 , \cf7 9\cf3 , \cf7 0\cf3 \}\
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentItem\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  
\f0\i \cf7 text items
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 configCode\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf11 length\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentItem\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf7 4\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentChars\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 characters
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentItem\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 isYear\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 no\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 a\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 1\cf3 \
			
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentChar\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 currentChars\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 isNum\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 no\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentNum\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 theNumList\cf3 \
					
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentChar\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf5 currentNum\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
						
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 isNum\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 yes\cf3 \
						
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 isNum\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 yes\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 a\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf7 4\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
						
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 isYear\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 yes\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 isNum\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 no\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 isYear\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 no\cf3 \
					
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 a\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 a\cf3  + \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 isYear\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 yes\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 currentItem\cf3 \
				
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "UNKNOWN"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "11-inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "11"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "12-inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "12"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "13-inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "13"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "15-inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "15"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "17-inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "17"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "20-inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "20"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "21.5-inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "21.5"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "24-inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "24"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "27-inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "27"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 displayModelNumber\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "ioreg -lw0 | grep \\\\\\"EDID\\\\\\" | sed \\"/[^<]*</s///\\" | xxd -p -r | strings -6 | grep 'LSN\\\\|LP'"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 displayModelNumber\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "154"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "15"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "UNKNOWN"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deviceScreenSize\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "UNKNOWN"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 buildSpecs\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkForNetwork\cf3 (\cf5 numTries\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 loadingProgressBar\cf3 (\cf10 "Network Check"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 i\cf3  
\f2\b \cf4 from
\f1\b0 \cf3  \cf7 1\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 numTries\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
		\cf6 progressBar\cf3 (\cf7 165\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Checking for network connection..."\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBarMultiplier\cf3 (\cf7 55\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
			
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "ping -o -t 2 www.google.com"\cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 networkTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 networkTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 networkTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 18\cf3 \
				\cf6 progressBar\cf3 (\cf7 55\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Network detected!"\cf3 )\
				\cf6 progressBarMultiplier\cf3 (\cf7 37\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf14 true\cf3 \
				
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Network not detected..."\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 55\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 i\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf5 numTries\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 36\cf3 \
				\cf6 progressBar\cf3 (\cf7 55\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Network not detected, continuing to "\cf3  & \cf5 mainAppName\cf3  & \cf10 "..."\cf3 )\
				\cf6 progressBarMultiplier\cf3 (\cf7 19\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 1\cf3 \
				
\f2\b \cf4 return
\f1\b0 \cf3  \cf14 false\cf3 \
				
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Waiting before trying again..."\cf3 )\
				\cf6 progressBarMultiplier\cf3 (\cf7 55\cf3 , \cf14 false\cf3 )\
				
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 1.25\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
			\cf6 progressBar\cf3 (\cf7 50\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Skipping network test..."\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 65\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf14 false\cf3 \
			
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkForNetwork\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkForUpdates\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf7 150\cf3 , \cf5 x\cf3 , \cf10 "Update Check"\cf3 , \cf10 "Checking for updates..."\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Updating time settings..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 false\cf3 )\
		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "sudo ntpdate -u time.apple.com"\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Getting remote address for Github..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 20\cf3 , \cf14 false\cf3 )\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 gitRemote\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "cd "\cf3  & \cf5 myFolderPathPOSIX\cf3  & \cf10 ";git config --get remote.origin.url"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Getting current working branch..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 20\cf3 , \cf14 false\cf3 )\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 gitBranch\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "cd "\cf3  & \cf5 myFolderPathPOSIX\cf3  & \cf10 ";git rev-parse --abbrev-ref HEAD"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Getting .plist file web address..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 20\cf3 , \cf14 false\cf3 )\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 plistAddress\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "https://raw.githubusercontent.com"\cf3  & (
\f0\i \cf7 text
\f1\i0 \cf3  (\cf11 length\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf10 "https://github.com/"\cf3 ) 
\f2\b \cf4 through
\f1\b0 \cf3  (\cf11 length\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 gitRemote\cf3 ) 
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 gitRemote\cf3 ) & \cf10 "/"\cf3  & \cf5 gitBranch\cf3  & \cf10 "/diagnostic-launcher.app/Contents/Resources/"\cf3  & \cf5 mainAppNameLong\cf3  & \cf10 "/Contents/Info.plist"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Downloading .plist file..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 20\cf3 , \cf14 false\cf3 )\
		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "cd "\cf3  & \cf5 tmpFiles\cf3  & \cf10 "; curl -O "\cf3  & \cf5 plistAddress\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Reading version from .plist file..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 20\cf3 , \cf14 false\cf3 )\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 newestVersion\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "defaults read "\cf3  & \cf5 tmpFiles\cf3  & \cf10 "Info.plist CFBundleShortVersionString"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Deleting downloaded .plist file..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 20\cf3 , \cf14 false\cf3 )\
		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  
\f0\i \cf7 file
\f1\i0 \cf3  (\cf5 tmpFiles\cf3  & \cf10 "/Info.plist"\cf3 ) 
\f2\b \cf8 exists
\f1\b0 \cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "rm "\cf3  & \cf5 tmpFiles\cf3  & \cf10 "/Info.plist"\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Comparing version numbers..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 20\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentVersion\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 less than
\f1\b0 \cf3  \cf5 newestVersion\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 return
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 mainAppError\cf3 (\cf10 "Main_App:004"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkForUpdates\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 promptToUpdate\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 try
\f1\b0 \cf3 \
				
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "Update"\cf3 , \cf10 "Remind me later"\cf3 \} \cf12 with prompt\cf3  \cf10 "Updates available!"\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "current version: "\cf3  & \cf5 currentVersion\cf3  & \cf11 return\cf3  & \cf10 "newest version: "\cf3  & \cf5 newestVersion\cf3  \cf12 default items\cf3  \cf10 "Update"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						
\f2\b \cf8 click
\f1\b0 \cf3  
\f0\i \cf7 button
\f1\i0 \cf3  \cf10 "Cancel"\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 window
\f1\i0 \cf3  \cf5 mainAppName\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 application process
\f1\i0 \cf3  \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf14 current application\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Update"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 return
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 mainAppError\cf3 (\cf10 "Main_App:005"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 promptToUpdate\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 updateApp\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 loadingProgressBar\cf3 (\cf10 "Updater"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 quitApp\cf3 (\cf10 "Terminal"\cf3 , \cf10 "Sec_App_Quit:001"\cf3 , \cf14 true\cf3 )\
	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Terminal"\cf3 \
		
\f2\b \cf8 activate
\f1\b0 \cf3 \
		
\f2\b \cf8 close
\f1\b0 \cf3  
\f0\i \cf7 windows
\f1\i0 \cf3 \
		
\f2\b \cf8 do script
\f1\b0 \cf3  \cf10 "cd "\cf3  & \cf5 myFolderPathPOSIX\cf3  & \cf10 ";git fetch;git stash;exit"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf7 60\cf3 , \cf5 x\cf3 , \cf10 "Updating"\cf3 , \cf10 "Fetching new changes and stashing current ones..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 20\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
	\cf6 waitForTerminalWindow\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Terminal"\cf3 \
		
\f2\b \cf8 activate
\f1\b0 \cf3 \
		
\f2\b \cf8 close
\f1\b0 \cf3  
\f0\i \cf7 windows
\f1\i0 \cf3 \
		
\f2\b \cf8 do script
\f1\b0 \cf3  \cf10 "cd "\cf3  & \cf5 myFolderPathPOSIX\cf3  & \cf10 ";git stash clear;exit"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "Updating"\cf3 , \cf10 "Clearing current stashes changes..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 20\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
	\cf6 waitForTerminalWindow\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Terminal"\cf3 \
		
\f2\b \cf8 activate
\f1\b0 \cf3 \
		
\f2\b \cf8 close
\f1\b0 \cf3  
\f0\i \cf7 windows
\f1\i0 \cf3 \
		
\f2\b \cf8 do script
\f1\b0 \cf3  \cf10 "cd "\cf3  & \cf5 myFolderPathPOSIX\cf3  & \cf10 ";sleep 4;killall applet;sleep 2;git pull;sleep 2; open "\cf3  & (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "mdfind diagnostic-launcher.app"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "Updating"\cf3 , \cf10 "Pulling new chagnes..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 20\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
	\cf6 waitForTerminalWindow\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 20\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 updateApp\cf3 \
\
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 waitForTerminalWindow\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Terminal"\cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 windowTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 history\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 window
\f1\i0 \cf3  \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 windowTest\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "[Process completed]"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf8 close
\f1\b0 \cf3  
\f0\i \cf7 windows
\f1\i0 \cf3 \
					
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
			\
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 waitForTerminalWindow\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 promptForChoice\cf3 (\cf5 optionChoice\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 optionChoice\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "diagnostic"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Processing"\cf3 , \cf10 "Stress Test"\cf3 , \cf10 "Label"\cf3 , \cf10 "Install macOS"\cf3 , \cf10 "Customer"\cf3 , \cf10 "Force Update"\cf3 \}\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Welcome to "\cf3  & \cf5 mainAppName\cf3  & \cf10 "."\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Please choose an option below."\cf3  & \cf11 return\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 optionChoice\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "finish"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Run Again"\cf3 , \cf10 "Shutdown Computer"\cf3 , \cf10 "Restart Computer"\cf3 , \cf10 "Quit"\cf3 \}\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "You have reached the end of "\cf3  & \cf5 mainAppName\cf3  & \cf10 "."\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Please choose an option below"\cf3  & \cf11 return\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
		
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \cf5 theList\cf3  \cf12 with prompt\cf3  \cf5 messageText\cf3  \cf12 default items\cf3  
\f0\i \cf7 item
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 theList\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 mainAppError\cf3 (\cf10 "Main_App:006"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 promptForChoice\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 diagnostic\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f0\i \cf7 missing value
\f1\i0 \cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 checkVSTModels\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f0\i \cf2 --checkLCD()
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 checkStorage\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f0\i \cf2 --checkRAM()
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 does not
\f1\b0 \cf3  
\f2\b \cf4 contain
\f1\b0 \cf3  \cf10 "Mac Mini"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 checkCamera\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f0\i \cf2 --checkBluetooth() -- TODO remove tmp txt file when done. spoof mac address
\f1\i0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "MacBook"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		\cf6 checkBattery\cf3 ()\
		\cf6 checkKeyborad\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 checkSound\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 notifyTests\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 diagnostic\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkVSTModels\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Retina"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "iMac"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "MacBook"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "15-Inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2012"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "iMac"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "27-Inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2011"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "MacBook"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "15-Inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2011"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "17-Inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2011"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Inch"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "ask"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 "UNKNOWN"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2010"\cf3  
\f2\b \cf4 or
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2011"\cf3  
\f2\b \cf4 or
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2012"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkVSTModels\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkLCD\cf3 ()\
	\
	
\f0\i \cf2 -- TODO
\f1\i0 \cf3 \
	\

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkLCD\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkStorage\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 loadingProgressBar\cf3 (\cf10 "Checking storage devices"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 " | "\cf3 \
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentDrive\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 driveListInfo\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentDriveDetails\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text items
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentDrive\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "="\cf3 \
		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentDriveDetail\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 currentDriveDetails\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentDriveDetail\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Reallocated Sectors="\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 RSC\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentDriveDetail\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentDriveDetail\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Current Pending="\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 CPS\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentDriveDetail\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 failedDrive\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 failedDriveDetails\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ""\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testCheck\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 RSC\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 "0"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 RSC\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 "**"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 failedDrive\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 failedDriveDetails\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 failedDriveDetails\cf3  & \cf11 space\cf3  & \cf10 "Reallocated Sectors= "\cf3  & \cf5 RSC\cf3  & \cf11 return\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testCheck\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 CPS\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 "0"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 CPS\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 "**"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 failedDrive\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 failedDriveDetails\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 failedDriveDetails\cf3  & \cf11 space\cf3  & \cf10 "Current Pending Sectors= "\cf3  & \cf5 CPS\cf3  & \cf11 return\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testCheck\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 testCheck\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\cf6 displayNotification\cf3 (\cf10 "Automatic hard drive test failed"\cf3 , \cf10 "Please review information in DriveDX"\cf3 )\
			\cf6 openApp\cf3 (\cf10 "DriveDX"\cf3 , \cf10 "Sec_App_Open:001"\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 failedDrive\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 printFailedDriveLabel\cf3 (\cf5 currentDrive\cf3 , \cf5 failedDriveDetails\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkStorage\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 printFailedDriveLabel\cf3 (\cf5 currentDrive\cf3 , \cf5 failedDriveDetails\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 " | "\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentDriveName\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentDrive\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "Yes"\cf3 , \cf10 "No"\cf3 \} \cf12 with prompt\cf3  \cf10 "Failed storage device detected."\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf5 currentDriveName\cf3  & \cf10 ":"\cf3  & \cf11 return\cf3  & \cf5 failedDriveDetails\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Would you like to print a label for it?"\cf3  \cf12 default items\cf3  \cf10 "Yes"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Yes"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 failedDrivePath\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 resourcesFolder\cf3  & \cf10 "ebayLabels/failedDrive/"\cf3 \
		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "echo "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentDrive\cf3  & \cf10 " > "\cf3  & \cf5 failedDrivePath\cf3  & \cf10 "driveLabelData"\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
		\cf6 runScript\cf3 (\cf10 "driveLabel.scpt"\cf3 , \cf5 failedDrivePath\cf3  & \cf10 "output.txt"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deleteItemList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "driveLabelData"\cf3 , \cf10 "generated.label"\cf3 , \cf10 "output.txt"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentItem\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 deleteItemList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "sudo rm "\cf3  & \cf5 failedDrivePath\cf3  & \cf5 currentItem\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
				
\f0\i \cf2 --display dialog e & return & currentItem & return & return & "sudo rm " & failedDrivePath & currentItem
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\cf6 displayNotification\cf3 (\cf10 "Error deleting failed drive print file "\cf3  & \cf5 currentItem\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "open "\cf3  & (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "mdfind -name diagnostic-launcher"\cf3 ))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 printFailedDriveLabel\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkRAM\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f0\i \cf2 (*\
	\
	deviceRAMSizeList, deviceRAMSpeedList -- will be "UNKNOWN" if error\
	deviceProcessorSpeed, deviceModelIdentifier -- compare against .txt file of minimum specs to get base specs\
	\
	if base specs are different then notify user\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf2 	*)
\f1\i0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkRAM\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkCamera\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf7 20\cf3 , \cf5 x\cf3 , \cf10 "Camera Check"\cf3 , \cf10 "Opening Photo Booth..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 openApp\cf3 (\cf10 "Photo Booth"\cf3 , \cf10 "Sec_App_Open:002"\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 endTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 )) + \cf7 10\cf3 \
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 until
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Photo Booth"\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf11 running\cf3 \
		
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 )\
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentTime\cf3  > \cf5 endTime\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application process
\f1\i0 \cf3  \cf10 "Photo Booth"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 window
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \{\cf11 position\cf3 , \cf11 size\cf3 \} 
\f2\b \cf4 to
\f1\b0 \cf3  \{\{\cf7 0\cf3 , \cf7 0\cf3 \}, \{\cf7 600\cf3 , \cf7 482\cf3 \}\}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 skipNext\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 endTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  ((
\f2\b \cf9 current date
\f1\b0 \cf3 ) + \cf7 15\cf3 ))\
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 colorHex\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "000000"\cf3 \
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 until
\f1\b0 \cf3  \cf5 colorHex\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 "000000"\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 colorHex\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf6 getHexOfCord\cf3 (\cf7 200\cf3 , \cf7 241\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Checking hex code of pixels in Photo Booth..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 1\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 ))\
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentTime\cf3  > \cf5 endTime\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
			
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 x\cf3  < \cf7 15\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 15\cf3 \
		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "Camera Check"\cf3 , \cf10 "Camera check passed..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 x\cf3  < \cf7 15\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 15\cf3 \
		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "Camera Check"\cf3 , \cf10 "Camera check failed..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
		
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "Continue"\cf3 , \cf10 "Quit"\cf3 \} \cf12 with prompt\cf3  \cf5 mainAppName\cf3  & \cf10 " detected a problem with the camera. Select Continue when you are ready to proceed."\cf3  \cf12 default items\cf3  \cf10 "Continue"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 quitApp\cf3 (\cf10 "Photo Booth"\cf3 , \cf10 "Sec_App_Quit:002"\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkCamera\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 getHexOfCord\cf3 (\cf5 fromLeft\cf3 , \cf5 fromTop\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "screencapture -R "\cf3  & \cf5 fromLeft\cf3  & \cf10 ","\cf3  & \cf5 fromTop\cf3  & \cf10 ",1,1 -t bmp $TMPDIR/cordHex.bmp"\cf3 \
	
\f2\b \cf4 return
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "xxd -p -l 3 -s 54 $TMPDIR/cordHex.bmp | sed 's/\\\\(..\\\\)\\\\(..\\\\)\\\\(..\\\\)/\\\\3\\\\2\\\\1/'"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 getHexOfCord\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkSound\cf3 ()\
	\
	
\f0\i \cf2 --activate me
\f1\i0 \cf3 \
	
\f0\i \cf2 --if deviceModelName contains "MacBook" then do shell script "sleep 5;oasscript -e 'tell application \\"Google Chrome\\" to activate' > /dev/null 2>&1 &"
\f1\i0 \cf3 \
	\
	
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
		\cf6 progressBar\cf3 (\cf7 20\cf3 , \cf5 x\cf3 , \cf10 "Sound Check"\cf3 , \cf10 "Waiting for user input..."\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "Start Test"\cf3 , \cf10 "Quit"\cf3 \} \cf12 with prompt\cf3  \cf10 "Select 'Start Test' when you are ready to test the microphone and speakers"\cf3  \cf12 default items\cf3  \cf10 "Start Test"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf9 set volume
\f1\b0 \cf3  \cf13 output volume\cf3  \cf7 100\cf3  
\f2\b \cf4 without
\f1\b0 \cf3  \cf13 output muted\cf3 \
	
\f2\b \cf9 set volume
\f1\b0 \cf3  \cf13 input volume\cf3  \cf7 50\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Opening System Preferences..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 openApp\cf3 (\cf10 "System Preferences"\cf3 , \cf10 "Sec_App_Open:003"\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 endTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 )) + \cf7 10\cf3 \
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 until
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Preferences"\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf11 running\cf3 \
		
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 )\
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentTime\cf3  > \cf5 endTime\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application process
\f1\i0 \cf3  \cf10 "System Preferences"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 window
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 position\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf7 0\cf3 , \cf7 0\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 does not
\f1\b0 \cf3  
\f2\b \cf4 contain
\f1\b0 \cf3  \cf10 "Mac Mini"\cf3  
\f2\b \cf4 or
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 does not
\f1\b0 \cf3  
\f2\b \cf4 contain
\f1\b0 \cf3  \cf10 "Mac Pro"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 playSound\cf3 (\cf7 0.5\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 playSound\cf3 (\cf7 0\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 does not
\f1\b0 \cf3  
\f2\b \cf4 contain
\f1\b0 \cf3  \cf10 "Mac Mini"\cf3  
\f2\b \cf4 or
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 does not
\f1\b0 \cf3  
\f2\b \cf4 contain
\f1\b0 \cf3  \cf10 "Mac Pro"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 playSound\cf3 (\cf7 1\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Preferences"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf8 reveal
\f1\b0 \cf3  
\f0\i \cf7 anchor
\f1\i0 \cf3  \cf10 "output"\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 pane
\f1\i0 \cf3  \cf14 id\cf3  \cf10 "com.apple.preference.sound"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 counter\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 slider
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 group
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 tab group
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 window
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 process
\f1\i0 \cf3  \cf10 "System Preferences"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 value\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0.5\cf3 \
				
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 counter\cf3  > \cf7 10\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 counter\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 counter\cf3  + \cf7 1\cf3 \
				
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Preferences"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf8 reveal
\f1\b0 \cf3  
\f0\i \cf7 anchor
\f1\i0 \cf3  \cf10 "input"\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 pane
\f1\i0 \cf3  \cf14 id\cf3  \cf10 "com.apple.preference.sound"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "Continue"\cf3 , \cf10 "Quit"\cf3 \} \cf12 with prompt\cf3  \cf10 "Select 'Continue' when you are done with the sound test"\cf3  \cf12 default items\cf3  \cf10 "Continue"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 quitApp\cf3 (\cf10 "System Preferences"\cf3 , \cf10 "Sec_App_Quit:003"\cf3 , \cf14 false\cf3 )\
	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkSound\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 playSound\cf3 (\cf5 outputBalance\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 outputBalance\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf7 0.5\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 outputBalanceText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "both speakers"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 outputBalance\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf7 0\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 outputBalanceText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "left speaker"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 outputBalance\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf7 1\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 outputBalanceText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "right speaker"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Testing "\cf3  & \cf5 outputBalanceText\cf3  & \cf10 "..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 does not
\f1\b0 \cf3  
\f2\b \cf4 contain
\f1\b0 \cf3  \cf10 "Mac Mini"\cf3  
\f2\b \cf4 or
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 does not
\f1\b0 \cf3  
\f2\b \cf4 contain
\f1\b0 \cf3  \cf10 "Mac Pro"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Preferences"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf8 reveal
\f1\b0 \cf3  
\f0\i \cf7 anchor
\f1\i0 \cf3  \cf10 "output"\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 pane
\f1\i0 \cf3  \cf14 id\cf3  \cf10 "com.apple.preference.sound"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 counter\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 slider
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 group
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 tab group
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 window
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 process
\f1\i0 \cf3  \cf10 "System Preferences"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 value\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 outputBalance\cf3 \
					
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 counter\cf3  > \cf7 10\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 counter\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 counter\cf3  + \cf7 1\cf3 \
					
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Preferences"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf8 reveal
\f1\b0 \cf3  
\f0\i \cf7 anchor
\f1\i0 \cf3  \cf10 "input"\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f0\i \cf7 pane
\f1\i0 \cf3  \cf14 id\cf3  \cf10 "com.apple.preference.sound"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3  \cf7 2\cf3  
\f2\b \cf4 times
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "afplay /System/Library/Sounds/Pop.aiff"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 playSound\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkBluetooth\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "system_profiler SPBluetoothDataType"\cf3 ) 
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		\cf6 loadingProgressBar\cf3 (\cf10 "Bluetooth Test"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
		\cf6 progressBar\cf3 (\cf7 35\cf3 , \cf5 x\cf3 , \cf10 "Bluetooth Test"\cf3 , \cf10 "Generating file to send over bluetooth..."\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Checking for bluetooth config file..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configFileLocation\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 configFolder\cf3  & \cf10 "bluetooth.plist"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  (
\f2\b \cf8 exists
\f1\b0 \cf3  
\f0\i \cf7 file
\f1\i0 \cf3  \cf5 configFileLocation\cf3 ) 
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf6 buildBluetoothConfigFile\cf3 (\cf5 configFileLocation\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Reading bluetooth config file..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 bluetoothMacAddress\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "defaults read "\cf3  & \cf5 configFileLocation\cf3  & \cf10 " bluetoothMacAddress"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 mainAppError\cf3 (\cf10 "Main_App:007"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 randomString\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ""\cf3 \
		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 from
\f1\b0 \cf3  \cf7 1\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 10\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 randomChar\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 ASCII character
\f1\b0 \cf3  (
\f2\b \cf9 random number
\f1\b0 \cf3  \cf12 from\cf3  \cf7 65\cf3  \cf12 to\cf3  \cf7 90\cf3 )) & (
\f2\b \cf9 ASCII character
\f1\b0 \cf3  (
\f2\b \cf9 random number
\f1\b0 \cf3  \cf12 from\cf3  \cf7 97\cf3  \cf12 to\cf3  \cf7 122\cf3 ))\
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 randomString\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 randomString\cf3  & \cf5 randomChar\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 fileBeginning\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "bluetoothTestFile"\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 randomString\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 fileBeginning\cf3  & \cf10 " - "\cf3  & (\cf11 date string\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 ) 
\f2\b \cf4 as
\f1\b0 \cf3  
\f0\i \cf7 text
\f1\i0 \cf3 ) & \cf10 " - "\cf3  & \cf5 randomString\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 bluetoothTestFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 resourcesFolder\cf3  & \cf5 randomString\cf3  & \cf10 ".txt"\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 bluetoothData\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 deviceSerialNumber\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 startTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 ))\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 endTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  ((
\f2\b \cf9 current date
\f1\b0 \cf3 ) + \cf7 20\cf3 ))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Sending generated file..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "echo "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 bluetoothData\cf3  & \cf10 " > "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 bluetoothTestFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Bluetooth File Exchange"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf8 send
\f1\b0 \cf3  \cf4 file\cf3  \cf5 bluetoothTestFile\cf3  \cf4 to device\cf3  \cf5 bluetoothMacAddress\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 terminalStartTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "date +%Y-%m-%d\\\\ %H:%M:%S"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 timeoutTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 skipNext\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
		
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 ))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
			
\f2\b \cf4 try
\f1\b0 \cf3 \
				
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 commandTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "log show --predicate '(subsystem == \\"com.apple.bluetooth\\") && (category == \\"bluetoothd\\")' --start \\""\cf3  & \cf5 terminalStartTime\cf3  & \cf10 "\\" --style json | grep 'EVENT: Disconnection Complete'"\cf3 \
					
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 commandTest\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Disconnection"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Waiting for Disconnection message..."\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 skipNext\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 is not
\f1\b0 \cf3  
\f2\b \cf4 equal to
\f1\b0 \cf3  \cf7 9\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 progressBarMultiplier\cf3 (\cf7 1\cf3 , \cf14 true\cf3 )\
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 skipNext\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 skipNext\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 skipNext\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentTime\cf3  > \cf5 endTime\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					\cf6 displayNotification\cf3 (\cf10 "Bluetooth test timed out"\cf3 , \cf10 "Manually check bluetooth hardware"\cf3 )\
					\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 timeoutTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
					
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\cf6 mainAppError\cf3 (\cf10 "Main_App:008"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.05\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 timeoutTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Bluetooth test passed..."\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 quitApp\cf3 (\cf10 "Bluetooth File Exchange"\cf3 , \cf10 "Sec_App_Quit:004"\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 displayNotification\cf3 (\cf10 "No bluetooth hardware detected"\cf3 , \cf10 ""\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 bluetoothTestFiles\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 paragraphs
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "ls "\cf3  & \cf5 resourcesFolder\cf3 )\
	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 bluetoothTestFiles\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 tmpDeleteFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 resourcesFolder\cf3  & \cf10 "tmpDeleteFile.txt"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentFile\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 bluetoothTestFiles\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentFile\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf5 fileBeginning\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "echo "\cf3  & \cf5 currentFile\cf3  & \cf10 " > "\cf3  & \cf5 tmpDeleteFile\cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deleteFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "sed 's/ /\\\\\\\\ /g' "\cf3  & \cf5 tmpDeleteFile\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
				
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "rm -r "\cf3  & \cf5 resourcesFolder\cf3  & \cf5 deleteFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\cf6 displayNotification\cf3 (\cf10 "Error removing bluetooth test file - "\cf3  & \cf5 currentFile\cf3 , \cf10 "Error details - "\cf3  & \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkBluetooth\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 buildBluetoothConfigFile\cf3 (\cf5 configFileLocation\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Bluetooth Mac Address| B8-8D-12-4B-B7-0F"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "| "\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 a\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 1\cf3 \
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentConfigItem\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 configList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 desiredItem\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentConfigItem\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 defaultItem\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentConfigItem\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "bluetooth.config file is missing. Please enter "\cf3  & \cf5 desiredItem\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 buttonsList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 , \cf10 "Finish"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 changedMessage\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 no\cf3 \
		
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf5 messageText\cf3  \cf12 default answer\cf3  \cf5 defaultItem\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3  \cf12 buttons\cf3  \cf5 buttonsList\cf3  \cf12 default button\cf3  \cf7 2\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 text returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 changedMessage\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 no\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 messageText\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Invalid entry, try again."\cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 changedMessage\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 yes\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 button returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Quit"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 desiredItem\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Bluetooth Mac Address"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 bluetoothMacAddress\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf13 text returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 a\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 a\cf3  + \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 plistText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "<plist version=\\"1.0\\">\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf10 	<dict>\
	<key>bluetoothMacAddress</key>\
	<string>"\cf3  & \cf5 bluetoothMacAddress\cf3  & \cf10 "</string>\
	</dict>\
</plist>"\cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "echo "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 plistText\cf3  & \cf10 " > "\cf3  & \cf5 configFileLocation\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 buildBluetoothConfigFile\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 notifyTests\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "system_profiler SPDiscBurningDataType"\cf3 ) 
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 displayNotification\cf3 (\cf10 "Optical drive"\cf3 , \cf10 "Insert CD"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Retina"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 displayNotification\cf3 (\cf10 "Retina display"\cf3 , \cf10 "Check for delamination"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "MacBook Air"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Mid 2012"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 displayNotification\cf3 (\cf10 "Mid 2012 MacBook Air detected"\cf3 , \cf10 "run SSD repair in AST"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 displayNotification\cf3 (\cf10 "VST model detected"\cf3 , \cf10 "Run VST test in AST"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 notifyTests\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 displayNotification\cf3 (\cf5 message1\cf3 , \cf5 message2\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Finder"\cf3 \
	
\f2\b \cf9 display notification
\f1\b0 \cf3  \cf5 message2\cf3  \cf12 subtitle\cf3  \cf5 message1\cf3  & \cf10 " detected"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 displayNotification\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkOSCompatibility\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "MacBook"\cf3  
\f2\b \cf4 and
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 does not
\f1\b0 \cf3  
\f2\b \cf4 contain
\f1\b0 \cf3  \cf10 "Pro"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  > \cf10 "2009"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  < \cf10 "2009"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2009"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Early"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Mid"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Late"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "MacBook Pro"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  > \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  < \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Early"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Mid"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Late"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "MacBook Air"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  > \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  < \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Early"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Mid"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Late"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Mac mini"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  > \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  < \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Early"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Mid"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Late"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "iMac"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  > \cf10 "2009"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  < \cf10 "2009"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2009"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Early"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Mid"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Late"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceModelName\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Mac Pro"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  > \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  < \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deviceYear\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "2010"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Early"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Mid"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 configCode\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Late"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 return
\f1\b0 \cf3  \cf10 "Ask"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkOSCompatibility\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkBattery\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf7 15\cf3 , \cf5 x\cf3 , \cf10 "Battery Check"\cf3 , \cf10 "Gathering battery information..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 batteryData\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 paragraphs
\f1\i0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "ioreg -brc AppleSmartBattery"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \{\cf5 fullChargeCapacity\cf3 , \cf5 cycleCount\cf3 , \cf5 designCapacity\cf3 \} 
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "UNKNOWN"\cf3 , \cf10 "UNKNOWN"\cf3 , \cf10 "UNKNOWN"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 " = "\cf3 \
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentLine\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 batteryData\cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentLine\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "MaxCapacity"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 fullChargeCapacity\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentLine\cf3 ) 
\f2\b \cf4 as
\f1\b0 \cf3  
\f0\i \cf7 integer
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentLine\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "\\"CycleCount\\" ="\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 cycleCount\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentLine\cf3 ) 
\f2\b \cf4 as
\f1\b0 \cf3  
\f0\i \cf7 integer
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentLine\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "\\"DesignCapacity\\" ="\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 designCapacity\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentLine\cf3 ) 
\f2\b \cf4 as
\f1\b0 \cf3  
\f0\i \cf7 integer
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Checking for errors in data..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testCheck\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 fullChargeCapacity\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "UNKNOWN"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testCheck\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 cycleCount\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "UNKNOWN"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testCheck\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 designCapacity\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "UNKNOWN"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testCheck\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 batteryHealth\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 round
\f1\b0 \cf3  ((\cf5 fullChargeCapacity\cf3  / \cf5 designCapacity\cf3 ) * \cf7 100\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 batteryHealth\cf3  \uc0\u8805  \cf7 85\cf3  
\f2\b \cf4 and
\f1\b0 \cf3  \cf5 cycleCount\cf3  \uc0\u8805  \cf7 2000\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 printFailedBatteryLabel\cf3 (\cf5 cycleCount\cf3 , \cf5 batteryHealth\cf3 )\
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 batteryHealth\cf3  < \cf7 80\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 printFailedBatteryLabel\cf3 (\cf5 cycleCount\cf3 , \cf5 batteryHealth\cf3 )\
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 batteryHealth\cf3  \uc0\u8805  \cf7 80\cf3  
\f2\b \cf4 and
\f1\b0 \cf3  \cf5 batteryHealth\cf3  < \cf7 85\cf3  
\f2\b \cf4 and
\f1\b0 \cf3  \cf5 cycleCount\cf3  \uc0\u8805  \cf7 1000\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 printFailedBatteryLabel\cf3 (\cf5 cycleCount\cf3 , \cf5 batteryHealth\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 testCheck\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Automatic battery test failed..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 displayNotification\cf3 (\cf10 "Automatic battery test failed"\cf3 , \cf10 "Please review information in CoconutBattery"\cf3 )\
		\cf6 openApp\cf3 (\cf10 "CoconutBattery"\cf3 , \cf10 "Sec_App_Open:004"\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Battery test passed..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkBattery\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 printFailedBatteryLabel\cf3 (\cf5 cycleCount\cf3 , \cf5 batteryHealth\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "Yes"\cf3 , \cf10 "No"\cf3 \} \cf12 with prompt\cf3  \cf10 "Failed battery detected."\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Cycles: "\cf3  & \cf5 cycleCount\cf3  & \cf11 return\cf3  & \cf10 "Health: "\cf3  & \cf5 batteryHealth\cf3  & \cf10 "%"\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Would you like to print a label for it?"\cf3  \cf12 default items\cf3  \cf10 "Yes"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Yes"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 failedBatteryPath\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 resourcesFolder\cf3  & \cf10 "ebayLabels/failedBattery/"\cf3 \
		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "echo 'cycleCount="\cf3  & \cf5 cycleCount\cf3  & \cf10 " | batteryHealth="\cf3  & \cf5 batteryHealth\cf3  & \cf10 "' > "\cf3  & \cf5 failedBatteryPath\cf3  & \cf10 "batteryLabelData"\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
		\cf6 runScript\cf3 (\cf10 "batteryLabel.scpt"\cf3 , \cf5 failedBatteryPath\cf3  & \cf10 "output.txt"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deleteItemList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "batteryLabelData"\cf3 , \cf10 "generated.label"\cf3 , \cf10 "output.txt"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentItem\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 deleteItemList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "sudo rm "\cf3  & \cf5 failedBatteryPath\cf3  & \cf5 currentItem\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
				
\f0\i \cf2 --display dialog e & return & currentItem & return & return & "sudo rm " & failedBatteryPath & currentItem
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\cf6 displayNotification\cf3 (\cf10 "Error deleting failed battery print file "\cf3  & \cf5 currentItem\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "open "\cf3  & (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "mdfind -name diagnostic-launcher"\cf3 ))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 printFailedBatteryLabel\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 checkKeyborad\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 quitApp\cf3 (\cf10 "Google Chrome"\cf3 , \cf10 "Sec_App_Quit:005"\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Google Chrome"\cf3 \
			
\f2\b \cf9 open location
\f1\b0 \cf3  \cf10 "http://keyboardchecker.com"\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  
\f2\b \cf4 the
\f1\b0 \cf3  \cf11 bounds\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 the
\f1\b0 \cf3  
\f2\b \cf4 first
\f1\b0 \cf3  
\f0\i \cf7 window
\f1\i0 \cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf7 0\cf3 , \cf7 0\cf3 , \cf7 854\cf3 , \cf7 642\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 appError\cf3 (\cf10 "Google Chrome"\cf3 , \cf10 "Sec_App_Run:001"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 checkKeyborad\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 stressTest\cf3 (\cf5 osInstallTest\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 sleepComputer\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 loadingProgressBar\cf3 (\cf10 "Stress Test"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf7 30\cf3 , \cf5 x\cf3 , \cf10 "Stress Test"\cf3 , \cf10 ""\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "Continue"\cf3 , \cf10 "Quit"\cf3 \} \cf12 with prompt\cf3  \cf10 "Select 'Continue' when you are ready to start stress test"\cf3  \cf12 default items\cf3  \cf10 "Continue"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 or
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 quitAppList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Terminal"\cf3 , \cf10 "Google Chrome"\cf3 , \cf10 "coconutBattery"\cf3 \}\
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentApp\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 quitAppList\cf3 \
		\cf6 quitApp\cf3 (\cf5 currentApp\cf3 , \cf10 "Sec_App_Quit:006"\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f0\i \cf7 missing value
\f1\i0 \cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 checkVSTModels\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testDuration\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 1800\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testDuration\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 300\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
		
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "5 Minutes"\cf3 , \cf10 "30 Minutes"\cf3 \} \cf12 with prompt\cf3  \cf10 "Unable to check for VST model automatically. How long would you like to run Stress Test?"\cf3  \cf12 default items\cf3  \cf10 "5 Minutes"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "30 Minutes"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testDuration\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 1800\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "5 Minutes"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 testDuration\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 300\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 checkVST\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 videoCardTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf6 startStressTest\cf3 (\cf6 xmrConfig\cf3 ()))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 videoCardTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
		
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "Run OpenMark"\cf3 , \cf10 "Continue with CPU stress only"\cf3 , \cf10 "Quit"\cf3 \} \cf12 with prompt\cf3  \cf5 mainAppName\cf3  & \cf10 " detected a problem with the video card."\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Would you like to run OpenMark to stress the GPU?"\cf3  \cf12 default items\cf3  \cf10 "Run OpenMark"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Run OpenMark"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf6 openApp\cf3 (\cf10 "OpenMark"\cf3 , \cf10 "Sec_App_Open:007"\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 quitApp\cf3 (\cf10 "Terminal"\cf3 , \cf10 "Sec_App_Quit:009"\cf3 , \cf14 true\cf3 )\
		\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 testDuration\cf3  < \cf7 500\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 timesToIncrease\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 10\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 timesToIncrease\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 startTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 ))\
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 endTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  ((
\f2\b \cf9 current date
\f1\b0 \cf3 ) + \cf5 testDuration\cf3 ))\
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 endTimeString\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time string\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  ((
\f2\b \cf9 current date
\f1\b0 \cf3 ) + \cf5 testDuration\cf3 ))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf5 testDuration\cf3  * \cf5 timesToIncrease\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Running stress test..."\cf3  & \cf11 return\cf3  & \cf10 "will complete at "\cf3  & \cf5 endTimeString\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 startTime\cf3 \
			
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 until
\f1\b0 \cf3  \cf5 currentTime\cf3  \uc0\u8805  \cf5 endTime\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 ))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 tmpTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 currentTime\cf3  - \cf5 startTime\cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 tmpTime\cf3  * \cf5 timesToIncrease\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentTime\cf3  < \cf5 endTime\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 repeat
\f1\b0 \cf3  \cf5 timesToIncrease\cf3  
\f2\b \cf4 times
\f1\b0 \cf3 \
						\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 )\
						
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 1\cf3  / \cf5 timesToIncrease\cf3 \
						
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 x\cf3  + \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 stressTestError\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 no\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBar\cf3 (\cf7 1\cf3 , \cf7 1\cf3 , \cf10 "***"\cf3 , \cf10 "Skipped stress test at "\cf3  & (\cf11 time string\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 )) & \cf10 "."\cf3  & \cf11 return\cf3  & \cf10 "Stress test ran for "\cf3  & (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 )) - \cf5 startTime\cf3  & \cf10 " seconds"\cf3 )\
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 stressTestError\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 yes\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 stressTestError\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 no\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 progressBar\cf3 (\cf7 1\cf3 , \cf7 1\cf3 , \cf10 "***"\cf3 , \cf10 "Stress test completed at "\cf3  & (\cf11 time string\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 )))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osInstallTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Continue"\cf3 , \cf10 "Quit"\cf3 \}\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Select \\"Continue\\" when you are ready to install the OS."\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osInstallTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 \}\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Select \\"Quit\\" when you are ready to Quit Stress Test."\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \cf5 theList\cf3  \cf12 with prompt\cf3  \cf5 messageText\cf3  \cf12 default items\cf3  
\f0\i \cf7 item
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 theList\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 appList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "OpenMark"\cf3 , \cf10 "SystemLoad"\cf3 , \cf10 "Terminal"\cf3 \}\
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentApp\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 appList\cf3 \
		\cf6 quitApp\cf3 (\cf5 currentApp\cf3 , \cf10 "Sec_App_Quit:007"\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 stressTest\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 sleepComputer\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf8 sleep
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 sleepComputer\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 xmrConfig\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Checking for main xmr config file..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configFileLocation\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 configFolder\cf3  & \cf10 "xmr.plist"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  (
\f2\b \cf8 exists
\f1\b0 \cf3  
\f0\i \cf7 file
\f1\i0 \cf3  \cf5 configFileLocation\cf3 ) 
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf6 buildXmrConfigFile\cf3 (\cf5 configFileLocation\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Reading main xmr config file..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 poolAddress\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "defaults read "\cf3  & \cf5 configFileLocation\cf3  & \cf10 " poolAddress"\cf3 )\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 walletAddress\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "defaults read "\cf3  & \cf5 configFileLocation\cf3  & \cf10 " walletAddress"\cf3 )\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 rigId\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "defaults read "\cf3  & \cf5 configFileLocation\cf3  & \cf10 " rigId"\cf3 )\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 poolPass\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "defaults read "\cf3  & \cf5 configFileLocation\cf3  & \cf10 " poolPass"\cf3 )\
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currency\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "defaults read "\cf3  & \cf5 configFileLocation\cf3  & \cf10 " currency"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 mainAppError\cf3 (\cf10 "Main_App:009"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 rigId\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "=driveIdentifier="\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 driveIdentifier\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 through
\f1\b0 \cf3  \cf7 -2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 path to
\f1\b0 \cf3  \cf13 startup disk\cf3  \cf12 as\cf3  
\f0\i \cf7 string
\f1\i0 \cf3 )\
		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "perl -pi -e 's/=driveIdentifier=/"\cf3  & \cf5 driveIdentifier\cf3  & \cf10 "/g' "\cf3  & \cf5 configFileLocation\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 rigId\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "defaults read "\cf3  & \cf5 configFileLocation\cf3  & \cf10 " rigId"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Building xmr config info..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 poolText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "\\"pool_list\\" :\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf10 [\
	\{\\"pool_address\\" : \\""\cf3  & \cf5 poolAddress\cf3  & \cf10 "\\", \\"wallet_address\\" : \\""\cf3  & \cf5 walletAddress\cf3  & \cf10 "\\", \\"rig_id\\" : \\"\\", \\"pool_password\\" : \\""\cf3  & \cf5 rigId\cf3  & \cf10 ":"\cf3  & \cf5 poolPass\cf3  & \cf10 "\\", \\"use_nicehash\\" : false, \\"use_tls\\" : false, \\"tls_fingerprint\\" : \\"\\", \\"pool_weight\\" : 1 \},\
],\
\
\\"currency\\" : \\""\cf3  & \cf5 currency\cf3  & \cf10 "\\","\cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 cpuTextTemp\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ""\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 y\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	
\f2\b \cf4 repeat
\f1\b0 \cf3  \cf5 deviceProcessorCores\cf3  
\f2\b \cf4 times
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 cpuTextTemp\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 cpuTextTemp\cf3  & \cf10 "    \{ \\"low_power_mode\\" : false, \\"no_prefetch\\" : true, \\"affine_to_cpu\\" : "\cf3  & \cf5 y\cf3  & \cf10 " \},\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf10     \{ \\"low_power_mode\\" : false, \\"no_prefetch\\" : true, \\"affine_to_cpu\\" : "\cf3  & \cf5 y\cf3  + \cf7 1\cf3  & \cf10 " \},"\cf3  & \cf11 return\cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 y\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 y\cf3  + \cf7 2\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 cpuText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "\\"cpu_threads_conf\\" :"\cf3  & \cf11 return\cf3  & \cf10 "["\cf3  & \cf11 return\cf3  & \cf5 cpuTextTemp\cf3  & \cf10 "],"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "\\"call_timeout\\" : 10,\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf10 \\"retry_time\\" : 30,\
\\"giveup_limit\\" : 0,\
\\"verbose_level\\" : 4,\
\\"print_motd\\" : true,\
\\"h_print_time\\" : 15,\
\\"aes_override\\" : null,\
\\"use_slow_memory\\" : \\"warn\\",\
\\"tls_secure_algo\\" : true,\
\\"daemon_mode\\" : false,\
\\"flush_stdout\\" : false,\
\\"output_file\\" : \\"\\",\
\\"httpd_port\\" : 0,\
\\"http_login\\" : \\"\\",\
\\"http_pass\\" : \\"\\",\
\\"prefer_ipv4\\" : true,"\cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Creating xmr config files..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 forceChoice\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentDevice\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 deviceGPUList\cf3 \
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentDevice\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "AMD"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 forceChoice\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 minerChoice\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "amd"\cf3 \
			
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentDevice\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Nvidia"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 forceChoice\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 minerChoice\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "nvidia"\cf3 \
			
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentDevice\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Intel"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 forceChoice\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 minerChoice\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "nvidia"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 forceChoice\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 minerChoice\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "amd"\cf3 , \cf10 "nvidia"\cf3 \} \cf12 with prompt\cf3  \cf10 "Unable to automatically select miner, please choose which one to run."\cf3  \cf12 default items\cf3  \cf10 "amd"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 xmrFolder\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf11 POSIX path\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 path to
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 ) & \cf10 "Contents/Resources/Applications/xmr-stak/"\cf3  & \cf5 minerChoice\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 videoTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/"\cf3  & \cf5 minerChoice\cf3  & \cf10 ".txt"\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/config.txt"\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 cpuTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/cpu.txt"\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 poolTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/pools.txt"\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 outputTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/output.txt"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configFileList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf5 videoTextFile\cf3 , \cf5 configTextFile\cf3 , \cf5 cpuTextFile\cf3 , \cf5 poolTextFile\cf3 , \cf5 outputTextFile\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentFile\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 configFileList\cf3 \
		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  
\f2\b \cf8 exists
\f1\b0 \cf3  
\f0\i \cf7 file
\f1\i0 \cf3  \cf5 currentFile\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "sudo rm -r "\cf3  & \cf5 currentFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "echo "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 configText\cf3  & \cf10 " > "\cf3  & \cf5 configTextFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "echo "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 cpuText\cf3  & \cf10 " > "\cf3  & \cf5 cpuTextFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "echo "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 poolText\cf3  & \cf10 " > "\cf3  & \cf5 poolTextFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 mainAppError\cf3 (\cf10 "Main_App:010"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 return
\f1\b0 \cf3  \cf5 xmrFolder\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 xmrConfig\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 buildXmrConfigFile\cf3 (\cf5 configFileLocation\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Pool Address| pool.supportxmr.com:3333"\cf3 , \cf10 "Wallet Address| 46pVaJ1DEN32WuVbomww3p4uiyyAvztgvDwBRnHYygeEedptYP8FZG9WdcQy4VA6XeKZPLDwmUR3tX9fNqUNLaoY9i5eKfe"\cf3 , \cf10 "Rid ID| =driveIdentifier="\cf3 , \cf10 "Pool Password| elitmadsen@gmail.com"\cf3 , \cf10 "Currency| monero7"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "| "\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 a\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 1\cf3 \
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentConfigItem\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 configList\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 desiredItem\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentConfigItem\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 defaultItem\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentConfigItem\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 a\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf7 1\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "xmr.config file is missing. Please enter "\cf3  & \cf5 desiredItem\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 buttonsList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 , \cf10 "Next"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 a\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf11 length\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 configList\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Please enter "\cf3  & \cf5 desiredItem\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 buttonsList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 , \cf10 "Finish"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "Please enter "\cf3  & \cf5 desiredItem\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 buttonsList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 , \cf10 "Next"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 changedMessage\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 no\cf3 \
		
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf5 messageText\cf3  \cf12 default answer\cf3  \cf5 defaultItem\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3  \cf12 buttons\cf3  \cf5 buttonsList\cf3  \cf12 default button\cf3  \cf7 2\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 text returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 changedMessage\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 no\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 messageText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 messageText\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Invalid entry, try again."\cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 changedMessage\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 yes\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 button returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Quit"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 desiredItem\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Pool Address"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 poolAddress\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf13 text returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 desiredItem\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Wallet Address"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 walletAddress\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf13 text returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 desiredItem\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Rid ID"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 rigId\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf13 text returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 desiredItem\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Pool Password"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 poolPass\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf13 text returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 desiredItem\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Currency"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currency\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf13 text returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 a\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 a\cf3  + \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 plistText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "<plist version=\\"1.0\\">\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf10 	<dict>\
	<key>poolAddress</key>\
	<string>"\cf3  & \cf5 poolAddress\cf3  & \cf10 "</string>\
	<key>walletAddress</key>\
	<string>"\cf3  & \cf5 walletAddress\cf3  & \cf10 "</string>\
	<key>rigId</key>\
	<string>"\cf3  & \cf5 rigId\cf3  & \cf10 "</string>\
	<key>poolPass</key>\
	<string>"\cf3  & \cf5 poolPass\cf3  & \cf10 "</string>\
	<key>currency</key>\
	<string>"\cf3  & \cf5 currency\cf3  & \cf10 "</string>\
	</dict>\
</plist>"\cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "echo "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 plistText\cf3  & \cf10 " > "\cf3  & \cf5 configFileLocation\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 buildXmrConfigFile\cf3 \
\

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 startStressTest\cf3 (\cf5 xmrFolder\cf3 )\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Starting xmr-stak..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 openApp\cf3 (\cf10 "Terminal"\cf3 , \cf10 "Sec_App_Open:005"\cf3 , \cf14 false\cf3 )\
	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Terminal"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf8 do script
\f1\b0 \cf3  \cf10 "cd "\cf3  & \cf5 xmrFolder\cf3  & \cf10 ";./xmr-stak"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 endTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  ((
\f2\b \cf9 current date
\f1\b0 \cf3 ) + \cf7 45\cf3 ))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Terminal"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 window
\f1\i0 \cf3  \cf7 1\cf3 \
		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 until
\f1\b0 \cf3  \cf11 history\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "Pool logged in."\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 ))\
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentTime\cf3  > \cf5 endTime\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf8 activate
\f1\b0 \cf3  \cf5 mainAppName\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
				
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "Continue to old tests"\cf3 , \cf10 "Quit"\cf3 \} \cf12 with prompt\cf3  \cf5 mainAppName\cf3  & \cf10 " detected a problem with xmr-stak."\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf10 "Would you like to run old stress tests?"\cf3  \cf12 default items\cf3  \cf10 "Continue to old tests"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\cf6 quitApp\cf3 (\cf10 "Terminal"\cf3 , \cf10 "Sec_App_Quit:008"\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 or
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 appList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "OpenMark"\cf3 , \cf10 "SystemLoad"\cf3 \}\
				
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentApp\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 appList\cf3 \
					\cf6 openApp\cf3 (\cf5 currentApp\cf3 , \cf10 "Sec_App_Open:006"\cf3 , \cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 endTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  ((
\f2\b \cf9 current date
\f1\b0 \cf3 ) + \cf7 16\cf3 ))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 videoCardTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 until
\f1\b0 \cf3  \cf11 history\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "(AMD)"\cf3  
\f2\b \cf4 or
\f1\b0 \cf3  \cf11 history\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "(NVIDIA)"\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentTime\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (\cf11 time\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 current date
\f1\b0 \cf3 ))\
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentTime\cf3  > \cf5 endTime\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 videoCardTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
				
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 amdVideoTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/"\cf3  & \cf10 "amd.txt"\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 nvidiaVideoTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/"\cf3  & \cf10 "nvidia.txt"\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/config.txt"\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 cpuTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/cpu.txt"\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 poolTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/pools.txt"\cf3 \
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 outputTextFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 xmrFolder\cf3  & \cf10 "/output.txt"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 configFileList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf5 amdVideoTextFile\cf3 , \cf5 nvidiaVideoTextFile\cf3 , \cf5 configTextFile\cf3 , \cf5 cpuTextFile\cf3 , \cf5 poolTextFile\cf3 , \cf5 outputTextFile\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentFile\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 configFileList\cf3 \
		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  
\f2\b \cf8 exists
\f1\b0 \cf3  
\f0\i \cf7 file
\f1\i0 \cf3  \cf5 currentFile\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "sudo rm -r "\cf3  & \cf5 currentFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 return
\f1\b0 \cf3  \cf5 videoCardTest\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 startStressTest\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 installOS\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 loadingProgressBar\cf3 (\cf10 "Install macOS"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Ask"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "High Sierra"\cf3 , \cf10 "El Capitan"\cf3 \} \cf12 with prompt\cf3  \cf10 "Unable to automatically select macOS version. Please selet which version to install."\cf3  \cf12 default items\cf3  \cf10 "High Sierra"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf8 quit
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "High Sierra"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "High Sierra"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "El Capitan"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "El Capitan"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf13 button returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf10 "Press enter when you are ready to install macOS."\cf3  \cf12 buttons\cf3  \{\cf10 "Quit"\cf3 , \cf10 "Continue"\cf3 \} \cf12 default button\cf3  \cf10 "Continue"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3  \cf12 cancel button\cf3  \cf10 "Quit"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 mainAppError\cf3 (\cf10 "Main_App:011"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Quit"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf7 15\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "El Capitan"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Mounting El Capitan .dmg file..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 3\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 runScript\cf3 (\cf10 "mountElCap.scpt"\cf3 , \cf10 "/dev/null"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBarMultiplier\cf3 (\cf7 2\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Preparing for High Sierra Install..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Unmounting and erasing internal drive..."\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentDrive\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 driveListInfo\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 " | "\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentDrive\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentDrive\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
			
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "diskutil unmountDisk force /dev/"\cf3  & \cf5 currentDrive\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 currentDrive\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f0\i \cf7 item
\f1\i0 \cf3  \cf7 -1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 driveListInfo\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 mainAppError\cf3 (\cf10 "Main_App:012"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorErase\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentDrive\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 driveListInfo\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 " | "\cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 currentDrive\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentDrive\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "diskutil eraseDisk JHFS+ Macintosh\\\\ HD /dev/"\cf3  & \cf5 currentDrive\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 displayNotification\cf3 (\cf10 "Error erasing partition. Check Disk Utility"\cf3 , \cf5 e\cf3 )\
			\cf6 openApp\cf3 (\cf10 "Disk Utility"\cf3 , \cf10 "Sec_App_Open:008"\cf3 , \cf14 false\cf3 )\
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorErase\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 errorErase\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf8 quit
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "High Sierra"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Restarting into install High Sierra..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "shutdown -r now"\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "El Capitan"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "***"\cf3 , \cf10 "Running install terminal commands..."\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 3\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 openApp\cf3 (\cf10 "Terminal"\cf3 , \cf10 "Sec_App_Open:009"\cf3 , \cf14 false\cf3 )\
		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "Terminal"\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f2\b \cf8 do script
\f1\b0 \cf3  \cf10 "if [ -d '/Volumes/Macintosh HD 1' ]; then installer -allowUntrusted -verboseR -pkg /Volumes/OS\\\\ X\\\\ Install\\\\ ESD/Packages/OSInstall.mpkg -target /Volumes/Macintosh\\\\ HD\\\\ 1 && reboot; else installer -allowUntrusted -verboseR -pkg /Volumes/OS\\\\ X\\\\ Install\\\\ ESD/Packages/OSInstall.mpkg -target /Volumes/Macintosh\\\\ HD && reboot ; fi"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBarMultiplier\cf3 (\cf7 12\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf8 quit
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 installOS\cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 labelPrint\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 loadingProgressBar\cf3 (\cf10 "Label Print"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deleteFiles\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "StoredCredential: "\cf3  & \cf11 POSIX path\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  (
\f2\b \cf9 path to
\f1\b0 \cf3  \cf13 home folder\cf3 ) & \cf10 ".credentials"\cf3 , \cf10 "Product_List: /Applications"\cf3 \}\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ": "\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deletedCredential\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 deleteFile\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 deleteFiles\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 1\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 deleteFile\cf3 \
			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 theFileLocation\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  
\f0\i \cf7 text item
\f1\i0 \cf3  \cf7 2\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 deleteFile\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBar\cf3 (\cf7 80\cf3 , \cf5 x\cf3 , \cf10 "Label Print"\cf3 , \cf10 "Deleting "\cf3  & \cf5 theFile\cf3  & \cf10 " file..."\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3  / (\cf11 length\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 deleteFiles\cf3 ), \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 foundFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "find "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 theFileLocation\cf3  & \cf10 " -name "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 theFile\cf3 )\
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 foundFile\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  
\f2\b \cf4 not
\f1\b0 \cf3  \cf10 ""\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "rm "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 foundFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 theFile\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "StoredCredential"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 deletedCredential\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf11 AppleScript's\cf3  \cf11 text item delimiters\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 oldDelims\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 deletedCredential\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Loading label script file\'85"\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Launching label script\'85"\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 runScript\cf3 (\cf10 "label.scpt"\cf3 , \cf10 "/dev/null 2>&1 &"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Skipping label script file\'85"\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Checking for log file\'85"\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 logFile\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 myPathPOSIX\cf3  & \cf10 "Contents/Logs/templog.txt"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
			
\f2\b \cf4 if
\f1\b0 \cf3  
\f2\b \cf8 exists
\f1\b0 \cf3  
\f0\i \cf7 file
\f1\i0 \cf3  \cf5 logFile\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 fileExists\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 fileExists\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 false\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 fileExists\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Deleting log file\'85"\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "rm -rf "\cf3  & \cf5 logFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Creating log file\'85"\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.2\cf3 \
		
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "date > "\cf3  & \cf5 logFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Launching label print software\'85"\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 9\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Waiting for label print software to finish\'85"\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 1\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "cd /Applications/MWApp;/Applications/MWApp/skumatchmacos.sh > "\cf3  & \cf5 logFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 on
\f1\b0 \cf3  
\f2\b \cf4 error
\f1\b0 \cf3  \cf5 e\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 mainAppError\cf3 (\cf10 "Main_App:013"\cf3 , \cf5 e\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Checking log file\'85"\cf3 )\
		\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 logText\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "cat "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 logFile\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 logText\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "No Label to print"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 repeat
\f1\b0 \cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf10 "Error: "\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf5 logText\cf3  \cf12 with title\cf3  \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  \cf12 buttons\cf3  \{\cf10 "More Information"\cf3 , \cf10 "Continue"\cf3 \} \cf12 default button\cf3  \cf7 2\cf3  \cf12 giving up after\cf3  \cf7 259200\cf3 )\
					
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 gave up\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 button returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "More Information"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 logFileMW\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "/Applications/MWApp/output.txt"\cf3 \
					
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 logTextMW\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "cat "\cf3  & \cf11 quoted form\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 logFileMW\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 logTextMW\cf3  
\f2\b \cf4 is not
\f1\b0 \cf3  
\f2\b \cf4 equal to
\f1\b0 \cf3  \cf5 logText\cf3  
\f2\b \cf4 as
\f1\b0 \cf3  
\f0\i \cf7 text
\f1\i0 \cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
						
\f2\b \cf4 repeat
\f1\b0 \cf3 \
							
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf10 "Details from "\cf3  & \cf5 logFileMW\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf5 logTextMW\cf3  \cf12 with title\cf3  \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  \cf12 buttons\cf3  \{\cf10 "Open Log File"\cf3 , \cf10 "Continue"\cf3 \} \cf12 default button\cf3  \cf7 1\cf3  \cf12 giving up after\cf3  \cf7 259200\cf3 )\
							
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 gave up\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							\
						
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
						\
					
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						
\f2\b \cf4 repeat
\f1\b0 \cf3 \
							
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 display dialog
\f1\b0 \cf3  \cf10 "No more information in MWApp log file "\cf3  & \cf11 return\cf3  & \cf11 return\cf3  & \cf5 logFileMW\cf3  \cf12 with title\cf3  \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3  \cf12 buttons\cf3  \{\cf10 "Open Log File"\cf3 , \cf10 "Continue"\cf3 \} \cf12 default button\cf3  \cf7 1\cf3  \cf12 giving up after\cf3  \cf7 259200\cf3 )\
							
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 gave up\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							\
						
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
					\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf4 if
\f1\b0 \cf3  \cf13 button returned\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "Open Log File"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
						
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "open "\cf3  & \cf5 logFileMW\cf3 \
						
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
				\
				
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "rm -rf "\cf3  & \cf5 logFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf14 true\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f0\i \cf2 (*\
				activate me\
				\
				with timeout of 259200 seconds\
					set response to (choose from list \{"Exit Label Print", "Restart Label Print", "Quit"\} default items "Exit Label Print" with prompt "Print error!" with title mainAppName)\
					\
				end timeout\
				\
				if response is \{"Quit"\} then\
					quitMainApp()\
					\
				else if response is false then\
					quitMainApp()\
					\
				else if response is \{"Exit Label Print"\} then\
					exit repeat\
					\
				else if response is \{"Restart Label Print"\} then\
					set errorTest to true\
					set x to 0\
					\
				end if\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf2 				*)
\f1\i0 \cf3 \
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
		
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "rm -rf "\cf3  & \cf5 logFile\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 errorTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Waiting for print job to start\'85"\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 appList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ""\cf3 \
			
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 while
\f1\b0 \cf3  \cf5 appList\cf3  
\f2\b \cf4 does not
\f1\b0 \cf3  
\f2\b \cf4 contain
\f1\b0 \cf3  \cf10 "PrinterProxy"\cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 appList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ""\cf3 \
				
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
					
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentApp\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  
\f2\b \cf4 every
\f1\b0 \cf3  
\f0\i \cf7 process
\f1\i0 \cf3 \
						
\f2\b \cf4 if
\f1\b0 \cf3  \cf11 background only\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentApp\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
							
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 appList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 appList\cf3  & \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentApp\cf3  & \cf10 " - "\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							\
						
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Waiting for print job to complete\'85"\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 10\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 appList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 "PrinterProxy"\cf3 \
			
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 while
\f1\b0 \cf3  \cf5 appList\cf3  
\f2\b \cf4 contains
\f1\b0 \cf3  \cf10 "PrinterProxy"\cf3 \
				
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 appList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf10 ""\cf3 \
				
\f2\b \cf4 tell
\f1\b0 \cf3  
\f0\i \cf7 application
\f1\i0 \cf3  \cf10 "System Events"\cf3 \
					
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentApp\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  
\f2\b \cf4 every
\f1\b0 \cf3  
\f0\i \cf7 process
\f1\i0 \cf3 \
						
\f2\b \cf4 if
\f1\b0 \cf3  \cf11 background only\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentApp\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
							
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 appList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf5 appList\cf3  & \cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf5 currentApp\cf3  & \cf10 " - "\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 							\
						
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
						\
					
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
					\
				
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 tell
\f1\b0 \cf3 \
				\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 0.5\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Done!"\cf3 )\
			\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf8 activate
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
		
\f2\b \cf4 with
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3  
\f2\b \cf4 of
\f1\b0 \cf3  \cf7 259200\cf3  
\f0\i \cf7 seconds
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  (
\f2\b \cf9 choose from list
\f1\b0 \cf3  \{\cf10 "Exit Label Print"\cf3 , \cf10 "Restart Label Print"\cf3 , \cf10 "Quit"\cf3 , \cf10 "Shutdown Computer"\cf3 , \cf10 "Restart Computer"\cf3 \} \cf12 with prompt\cf3  \cf10 "You have reached the end of label print. Please select an option below."\cf3  \cf12 default items\cf3  \cf10 "Exit Label Print"\cf3  \cf12 with title\cf3  \cf5 mainAppName\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 timeout
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 quitAppList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "Google Chrome"\cf3 \}\
		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentApp\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 quitAppList\cf3 \
			\cf6 quitApp\cf3 (\cf5 currentApp\cf3 , \cf10 "Sec_App_Quit:010"\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Exit Label Print"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf4 exit
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Shutdown Computer"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "sudo shutdown -h now"\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
			\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Restart Computer"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "sudo shutdown -r now"\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
			\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
	
\f2\b \cf4 try
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf9 do shell script
\f1\b0 \cf3  (\cf10 "open "\cf3  & (
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "mdfind -name diagnostic-launcher"\cf3 ))\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 try
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf8 delay
\f1\b0 \cf3  \cf7 1\cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 labelPrint\cf3 \
\
\
\
\
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 ---------- MAIN SCRIPT
\f1\i0 \cf3 \
\

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 on
\f1\b0 \cf3  \cf6 runMainScript\cf3 ()\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 setGlobalsMissing\cf3 ()\
	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 mainAppList\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \{\cf10 "coconutBattery"\cf3 , \cf10 "DriveDx"\cf3 , \cf10 "Finder"\cf3 , \cf10 "Google Chrome"\cf3 , \cf10 "OpenMark"\cf3 , \cf10 "Photo Booth"\cf3 , \cf10 "SystemLoad"\cf3 , \cf10 "System Preferences"\cf3 , \cf10 "Terminal"\cf3 \}\
	
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentApp\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 mainAppList\cf3 \
		\cf6 quitApp\cf3 (\cf5 currentApp\cf3 , \cf10 "Sec_App_Quit:011"\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 unmountDisks\cf3 ()\
	\cf6 setGlobals\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 networkTest\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf6 checkForNetwork\cf3 (\cf7 10\cf3 )\
	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 networkTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		\cf6 checkForUpdates\cf3 ()\
		
\f2\b \cf4 if
\f1\b0 \cf3  \cf11 result\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
			\cf6 promptToUpdate\cf3 ()\
			
\f2\b \cf4 if
\f1\b0 \cf3  \cf11 result\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
				\cf6 updateApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 				\
			
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
	\
	\
	\
	\
	
\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
	\
	
\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
	\
	\
	\
	\
	\
	
\f0\i \cf2 -- TODO move this to a handle to clean up code
\f1\i0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 loadingProgressBar\cf3 (\cf10 "Config Code checks"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 x\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf7 0\cf3 \
	\cf6 progressBar\cf3 (\cf7 25\cf3 , \cf5 x\cf3 , \cf10 "Config Code checks"\cf3 , \cf10 ""\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 networkTest\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 true\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
		\cf6 getConfigCode\cf3 ()\
		\cf6 buildSpecs\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 progressBar\cf3 (\cf10 "***"\cf3 , \cf5 x\cf3 , \cf10 "***"\cf3 , \cf10 "Checking for macOS version"\cf3 )\
	\cf6 progressBarMultiplier\cf3 (\cf7 5\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf6 checkOSCompatibility\cf3 ()\
	
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 osVersion\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf10 "El Capitan"\cf3  
\f2\b \cf4 then
\f1\b0 \cf3  \cf6 runScript\cf3 (\cf10 "mountElCap.scpt"\cf3 , \cf10 "/dev/null 2>&1 &"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f0\i \cf2 -- TODO move this to a handle to clean up code
\f1\i0 \cf3 \
	\
	\
	\
	\
	\
	
\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
	\
	
\f0\i \cf2 --------------------------------------------------
\f1\i0 \cf3 \
	\
	\
	\
	\
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\cf6 loadingProgressBar\cf3 (\cf11 name\cf3  
\f2\b \cf4 of
\f1\b0 \cf3  
\f2\b \cf4 me
\f1\b0 \cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 	
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf6 promptForChoice\cf3 (\cf10 "diagnostic"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Processing"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
			\cf6 diagnostic\cf3 ()\
			\cf6 stressTest\cf3 (\cf14 true\cf3 )\
			\cf6 installOS\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Stress Test"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 stressTest\cf3 (\cf14 true\cf3 )\
			\cf6 installOS\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Label"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 labelPrint\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Install macOS"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 installOS\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Customer"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 diagnostic\cf3 ()\
			\cf6 stressTest\cf3 (\cf14 false\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Force Update"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 updateApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 set
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 to
\f1\b0 \cf3  \cf6 promptForChoice\cf3 (\cf10 "finish"\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 repeat
\f1\b0 \cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf5 currentApp\cf3  
\f2\b \cf4 in
\f1\b0 \cf3  \cf5 mainAppList\cf3 \
			\cf6 quitApp\cf3 (\cf5 currentApp\cf3 , \cf10 "Sec_App_Quit:012"\cf3 , \cf14 true\cf3 )\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
		\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 		
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Shutdown Computer"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
			
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "sudo shutdown -h now"\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
			\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Restart Computer"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			
\f2\b \cf9 do shell script
\f1\b0 \cf3  \cf10 "sudo shutdown -r now"\cf3  
\f2\b \cf4 with
\f1\b0 \cf3  \cf12 administrator privileges\cf3 \
			\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Run Again"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \{\cf10 "Quit"\cf3 \} 
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 else
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3  \cf5 response\cf3  
\f2\b \cf4 is
\f1\b0 \cf3  \cf14 false\cf3  
\f2\b \cf4 then
\f1\b0 \cf3 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\cf6 quitMainApp\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 			\
		
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 if
\f1\b0 \cf3 \
		\
	
\f2\b \cf4 end
\f1\b0 \cf3  
\f2\b \cf4 repeat
\f1\b0 \cf3 \
	\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f2\b \cf4 end
\f1\b0 \cf3  \cf6 runMainScript\cf3 \
\
\cf6 runMainScript\cf3 ()\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0
\cf3 \
\
\
\
\
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
\

\f0\i \cf2 ---------- END
\f1\i0 \cf3 \
\

\f0\i \cf2 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\f1\i0 \cf3 \
}